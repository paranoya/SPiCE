from abc import ABCMeta, abstractmethod

#-------------------------------------------------------------------------------

class IMF(object):
    """Initial Mass Function"""
    
    __metaclass__ = ABCMeta
    
    @abstractmethod
    def __init__(self):
        print 'IMF constructor callled'
    
    @abstractmethod
    def phi(m):
        """
        Given stellar mass m, in solar masses,
        return the number of stars between m and m+dm, per unit total mass,
        \n dN/dm / int_0^\infty m dN/dm dm \n
        in solar masses^-2
        """
        pass
    
    def create(self,imf,args):
        if IMF_options.has_key(imf)(args):
            return IMF_options[imf]
        else:
            print 'Requested IMF not available:', imf
            
#-------------------------------------------------------------------------------

class Salpeter(IMF):
    """Salpeter (1955; ApJ 121, 161)"""
    
    def __init__(self, m_min=.1, m_max=100):
        print 'Salpeter constructor callled'
        self.m_min = m_min
        self.m_max = m_max
  
    def phi(self, m):
        if( m<self.m_min or m>self.m_max ):
            return 0
        return(m**-2.35)
      
#-------------------------------------------------------------------------------

class Kroupa(IMF):
    """Kroupa (2001; ...)"""
    
#    def __init__(self):
#        self.m_min = 0.1
#        self.m_max = 100
  
    def phi(self, m):
        print "NOT DEFINED YET!!!"
      
#-------------------------------------------------------------------------------

IMF_options = {}
IMF_options['Salpeter'] = Salpeter

#-------------------------------------------------------------------------------
class IMF_2():
    
    def __init__(self):
        
        self.imfs_dict = {}
        self.imfs_dict['sal'] = self.salpeter
        self.imfs_dict['kro'] = self.kroupa
        
    def phi_salpeter(self,a, b, c):
        self.a = 0
        self.b = 100
        self.c = 1
        return a+b+c
        
    def phi_kroupa(self):
       return 1
    
